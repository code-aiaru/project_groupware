<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <!-- head 부분 내용 -->
  <meta charset="UTF-8">
  <title>게시물 생성</title>
</head>
<body>
<h1>게시물 생성</h1>
<form id="createBoardForm">
  <label for="title">제목</label>
  <input type="text" id="title" name="title" required>
  <label for="writer">작성자</label>
  <input type="text" id="writer" name="writer" required>
  <label for="boardPw">비밀번호</label>
  <input type="password" id="boardPw" name="boardPw" required>
  <br>
  <label for="content">내용</label>
  <textarea id="content" name="content" required></textarea>
  <br>
  <button type="button" onclick="createBoard()">게시물 등록</button>
</form>
<a href="/boards/list">게시판 목록으로 돌아가기</a>

<script>
function createBoard() {
    // 입력된 제목, 작성자, 내용, 비밀번호를 가져옵니다.
    var title = document.getElementById("title").value;
    var writer = document.getElementById("writer").value;
    var content = document.getElementById("content").value;
    var boardPw = document.getElementById("boardPw").value;

    // JSON 데이터를 생성합니다.
    var jsonData = {
        title: title,
        writer: writer,
        content: content,
        boardPw: boardPw
    };

    // 서버로 JSON 데이터를 전송합니다.
    fetch("/api/boards", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(jsonData)
    })
    .then(function(response) {
        if (response.ok) {
            console.log("게시물이 성공적으로 생성되었습니다.");
            window.location.href = "/boards/list";
        } else {
            console.error("게시물 생성 오류: " + response.status);
        }
    })
    .catch(function(error) {
        console.error("네트워크 오류: " + error);
    });
}

// 백엔드에서 무작위 작성자명을 가져오는 함수
function getRandomWriterFromBackend() {
    return fetch('/api/boards/getRandomWriter')
        .then(response => response.text())
        .catch(error => {
            console.error("작성자명 가져오기 오류: " + error);
        });
}

// 페이지 로드 시 무작위 작성자명을 가져와서 input에 설정
getRandomWriterFromBackend()
.then(function(writer) {
    document.getElementById("writer").value = writer;
});

</script>

</body>
</html>